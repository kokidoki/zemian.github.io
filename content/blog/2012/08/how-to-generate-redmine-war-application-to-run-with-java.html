title=How to generate Redmine WAR application to run with Java
date=2012-08-06
type=post
tags=jruby, redmine, issue-tracker
status=published
~~~~~~
<p>If you survey around Java open source land, it's really disappointing in not able to  find a decent project management web app that we can use. The Java war file deployment in an app server is easy to use, and it would give us good performance. Especially if we already in a Java shop, having a project management tool that deploys in an existing app server would be easier to maintain.</p>

<p>I have found the Ruby's <a href="http://www.redmine.org">Redmine</a> to be a very good ONE-STOP-SHOP for most of your project development need. It has nice clean web interface, and the features are loaded: projects, users, issue tracking, wiki, source control viewer, documents, and it even has time tracking.</p>

<p>Altough the application is written in Ruby on Rails, you can run this with the JRuby perfectly fine on any Java app server. I've just done this and able to run it on JBossAS7.1.0 with jruby-1.6.7.2 and redmine-2.03.</p>

<p>For the impatients, you can actually grab my generated <code>redmine-2.0.3.war</code> from <a href="https://bitbucket.org/saltnlight5/sandbox/downloads">my sandbox</a>. I even provided an MySQL sql dump for you to get started without have to go through the building the war file. If you want to change the DB or any other settings, you can simply unpack the war file and edit the config files, then re-jar the war backup. This is still easier than building the war from scratch.</p>

<p>Here is how I build the war file. First step is setup a database. I picked MySQL.</p>

<pre><code>mysql&gt; create database redmine character set utf8;
mysql&gt; create user 'redmine'@'localhost' identified by 'redmine123';
mysql&gt; grant all privileges on redmine.* to 'redmine'@'localhost';
</code></pre>

<p>Then prepare the Redmine with JRuby. Download the <code>redmine-2.0.3.zip</code> and unzip and then cd into this directory. Then run the following:</p>

<pre><code>$ $JRUBY_HOME/bin/gem install bundler
$ $JRUBY_HOME/bin/bundle install --without development test rmagick postgresql sqlite
$ cp config/database.yml.example config/database.yml
$ # edit config/database.yml
$ # type in your database connection info for "production" env.
$ $JRUBY_HOME/bin/rake generate_secret_token
$ RAILS_ENV=production $JRUBY_HOME/bin/rake db:migrate
$ RAILS_ENV=production $JRUBY_HOME/bin/rake redmine:load_default_data
</code></pre>

<p>Now create the war file.</p>

<pre><code>$ $JRUBY_HOME/bin/gem install warbler
$ $JRUBY_HOME/bin/warble config
$ # edit config/warble.rb
$ # replace: config.dirs = %w(app config lib log vendor tmp extra files)
$ # add: config.gems += ["activerecord-jdbcmysql-adapter", "jruby-openssl", "i18n", "rack"]
$ $JRUBY_HOME/bin/warble
</code></pre>

<p>After this, you will see <code>redmine-2.0.3.war</code> in the directory. Now you can drop it into any app server and you may kick start any projects!</p>