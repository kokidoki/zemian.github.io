title=A very lean war file for MySchedule
date=2012-10-22
type=post
tags=myschedule, quartz
status=published
~~~~~~
<span class="Apple-style-span" style="background-color: white;"><span class="Apple-style-span" style="font-family: Georgia, 'Times New Roman', serif;">On the&nbsp;</span></span><span class="Apple-style-span" style="background-color: white; font-family: Georgia, 'Times New Roman', serif;">next</span><span class="Apple-style-span" style="background-color: white; font-family: Georgia, 'Times New Roman', serif;">&nbsp;coming MySchedule release, I've been working on removing few dependencies in the project to improve its size, but yet still keeping all the original&nbsp;functionality.</span><br />
<span class="Apple-style-span" style="font-family: Georgia, 'Times New Roman', serif;"><br /></span><br />
<span class="Apple-style-span" style="background-color: white; font-family: Georgia, 'Times New Roman', serif;"></span><br />
<div>
<span class="Apple-style-span" style="background-color: white; font-family: Georgia, 'Times New Roman', serif;">The <a href="http://code.google.com/p/myschedule/downloads/list"><span id="goog_20444744"></span>result</a>&nbsp;is about 70% reduction in war file size!</span></div>
<span class="Apple-style-span" style="font-family: Georgia, 'Times New Roman', serif;"><br /></span><br />
<span class="Apple-style-span" style="background-color: white; font-family: Georgia, 'Times New Roman', serif;">There are few things that I removed that resulted in a much smaller webapp.</span><br />
<span class="Apple-style-span" style="background-color: white; font-family: Georgia, 'Times New Roman', serif;"><br />1. Removed MySQL jdbc driver. Not every one uses Quartz with this DB, so including it in distribution is not necessary. You can easily add it into a server classpath without modifying the war.<br /><br />2. Removed Groovy. I've improved the UI and the ScriptingJob component so that it works with any Java standard script engine. The JDK comes with JavaScript engine built-in! So now Groovy can be optional, and yet user can still use it by simply add it to the server classpath, and they can select the language in MySchedule UI. Without it, MySchedule will just default to JavaScript for scripting.<br /><br />3. Removed Spring (MVC) Framework. Now this is a big task because MySchedule uses Spring annotations, controllers and service beans in IoC config to bootstrap the entire webapp. I've replaced it with a simple static <a href="http://code.google.com/p/myschedule/source/browse/myschedule-web/src/main/java/myschedule/web/AppConfig.java">AppConfig</a> that wired my services together, and then used the plain Servlet API to process all http requests.</span><br />
<span class="Apple-style-span" style="background-color: white; font-family: Georgia, 'Times New Roman', serif;"><br /></span><br />
<span class="Apple-style-span" style="background-color: white; font-family: Georgia, 'Times New Roman', serif;">So why remove Spring? Don't get me wrong, I like working with Spring, and I think it's awesome framework.&nbsp;</span><span class="Apple-style-span" style="font-family: Georgia, 'Times New Roman', serif;"><span class="Apple-style-span" style="background-color: white;">I have been working with Spring based projects for a long time, and I even have my own set of <a href="http://code.google.com/p/zemiandeng/source/browse/springmvc-project-template">SpringMVC template</a> to<br />start any web application quickly. I know where things are configured and where to add new code to make a Spring app works, and it's flexibility are fantastic for development, especially for larger projects. &nbsp;But in MySchedule case, it is just a small webapp that has it's focus is on Quartz. I wanted to remove Spring to create less confusion for any one who want to look at the code. The Spring bundled with Quartz in its core, and I want to avoid (I didn't use any of that any way.) I also want to shrink the war file size. And lastly, just to&nbsp;</span><span class="Apple-style-span" style="background-color: white;">challenge of myself that, yes there is life outside of Spring, and it still can be maintainable. :-P</span></span><br />
<span class="Apple-style-span" style="background-color: white; font-family: Georgia, 'Times New Roman', serif;"><br /></span><br />
<span class="Apple-style-span" style="background-color: white; font-family: Georgia, 'Times New Roman', serif;">So in replacing Spring, but kept very much of same coding style, I have created my tiny little web request processing library. It only has few classes, and it will allow me to use single Servlet controller to map and process all URL actions through many smaller unit of code, which I called action handler. Now MySchedule can be easily configured through one&nbsp;<a href="http://code.google.com/p/myschedule/source/browse/myschedule-web/src/main/java/myschedule/web/servlet/app/MainServlet.java">MainServlet </a>class. Not bad!</span><br />
<span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: x-small;"><br /></span>