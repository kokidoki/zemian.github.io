title=How to manage Maven third party jars
date=2013-06-23
type=post
tags=maven
status=published
~~~~~~
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_how_to_manage_maven_third_party_jars">How to manage Maven third party jars</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you find yourself the need to load third party jars into Maven repository,
there are few steps you normally do to test it out. You first install them
locally into <code>$HOME/.m2/repository</code>, and then create your project pom that
list those dependency. When things look good, then you deploy into your own
hosted repository. The following scripts will help you perform these tasks.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">

If you have lot&#8217;s of jars under a group, it&#8217;s more conveninent to create
an extra pom that list these dependency and install/deploy it into the repository
as well. And then your project would only need to include one dependency
with <code>&lt;type&gt;pom&lt;/type&gt;</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">bin/mvn-install.sh</div>
<div class="content monospaced">
<pre>#!/usr/bin/env bash
#
# Install local jar files into Maven repository. The artifact name would be same
# as the filename minus the extension.
# :Author: Zemian Deng
# :Date: 2013/06/17
#
# Usage:
#   # Print as maven dependency used in pom file
#   mvn-install.sh mygroup 1.0.0 lib/*.jar
#
#   # Install jar files into local maven repo
#   RUN_TYPE=install mvn-install.sh mygroup 1.0.0 lib/*.jar
#
#   # Deploy jar files into remote maven repo
#   export REPO_URL=http://localhost/nexus/content/repositories/thirdparty
#   RUN_TYPE=deploy mvn-install.sh mygroup 1.0.0 lib/*.jar
#

# Capture command arguments and options
GROUP=$1
shift
VERSION=$1
shift
FILES="$@"
if [[ "$GROUP" == "" || "$VERSION" == "" || "$FILES" == "" ]]; then
 printf "ERROR: invalid arguments: GROUP VERSION FILES...\n"
 exit 1
fi

RUN_TYPE=${RUN_TYPE:="print"} # values: print|install|deploy
REPO_ID=${REPO_ID:="nexus-server"} # Id defined in user's settings.xml for authentication
REPO_URL=${REPO_URL:="http://localhost/nexus/content/repositories/thirdparty"}

# For each file, perform action based on run type.
for FILE in $FILES; do
 ARTIFACT=`basename $FILE '.jar'`
 if [[ "$RUN_TYPE" == "deploy" ]]; then
  printf "Deploying file=$FILE as artifact=$ARTIFACT to repo=$REPO_URL\n"
  mvn deploy:deploy-file \
   -DrepositoryId=$REPO_ID -Durl=$REPO_URL \
   -DgroupId=$GROUP -DartifactId=$ARTIFACT -Dversion=$VERSION -Dpackaging=jar \
   -Dfile=$FILE
 elif [[ "$RUN_TYPE" == "install" ]]; then
  printf "Installing file=$FILE as artifact=$ARTIFACT\n"
  mvn install:install-file \
   -DgroupId=$GROUP -DartifactId=$ARTIFACT -Dversion=$VERSION -Dpackaging=jar \
   -Dfile=$FILE
 elif [[ "$RUN_TYPE" == "print" ]]; then
  printf "        &lt;dependency&gt;\n"
  printf "            &lt;groupId&gt;$GROUP&lt;/groupId&gt;\n"
  printf "            &lt;artifactId&gt;$ARTIFACT&lt;/artifactId&gt;\n"
  printf "            &lt;version&gt;$VERSION&lt;/version&gt;\n"
  printf "        &lt;/dependency&gt;\n"
 fi
done</pre>
</div>
</div>

</div>
</div>

</div>
<div id="footer">
<div id="footer-text">
Last updated 2013-06-18 19:14:37 EDT
</div>
</div>