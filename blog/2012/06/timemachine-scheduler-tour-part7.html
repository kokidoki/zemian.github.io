<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Zemian's Blog - TimeMachine Scheduler Tour: Part7</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="JBake">

    <!-- Le styles -->
    <link href="../../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../../css/asciidoctor.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link href="../../../css/prettify.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="../../../favicon.ico">
  </head>
  <body onload="prettyPrint()">
    <div id="wrap">
	
	<!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../../">Zemian's Blog</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../../../index.html">Home</a></li>
            <li><a href="../../../about.html">About</a></li>
            <li><a href="../../../archive.html">Archive</a></li>
            <li><a href="../../..//tags">Tags</a></li>
            <li><a href="../../../feed.xml">Subscribe</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
    <div class="container">	
	<div class="page-header">
		<h1>TimeMachine Scheduler Tour: Part7</h1>
	</div>

	<p><em>24 June 2012</em></p>

	<p><br />
<span style="background-color: white;">This is part 7 of 7 in a series of articles that will give you a tour of the&nbsp;</span><a href="https://bitbucket.org/timemachine/scheduler/wiki/Home" style="background-color: white;">TimeMachine Scheduler</a><span style="background-color: white;">&nbsp;project. These articles will introduce you to the scheduler, how to load jobs and schedules, and explore some of its advanced features. For the most current and accurate instructions, please visit the ReferenceManual from the project site.</span><br />
<br />
<br />
<h2>








Running Multiple Schedulers in a Clustering Mode</h2>
One of&nbsp;<span style="background-color: white;">TimeMachine Scheduler goal is to be scalable and run high number of jobs. One of the way to do this is be able to run multiple schedulers on separate JVM under a single logical scheduler data space. In previous articles, you might already have noticed that our data models were designed to support multiple scheduler data space from the begining. This feature is actually already implicitly enabled by default, and you do not have to do much to take advantage of it!</span><br />
<span style="background-color: white;"><br /></span><br />
<span style="background-color: white;">When running multiple schedulers (usually on separated JVM, but not required), your scheduler configuration is still all the same, except you need to pay attention to these two properties:</span><br />
<span style="background-color: white;"><br /></span><br />
<span style="background-color: white;">







</span><br />
<div class="p1">
<span style="background-color: white;"><span style="font-family: 'Courier New',Courier,monospace; font-size: x-small;">timemachine.scheduler.schedulerName = <span class="s1">TimeMachineScheduler</span></span></span></div>
<span style="background-color: white;">
</span><br />
<div class="p1">
<span style="background-color: white;"><span style="font-family: 'Courier New',Courier,monospace; font-size: x-small;">timemachine.scheduler.nodeName = <span class="s1">#{</span><span class="s2">hostname</span><span class="s1">}</span></span></span></div>
<span style="background-color: white;">
</span><br />
<div class="p1">
<span style="background-color: white;"><br /></span></div>
<span style="background-color: white;">
</span><br />
<div class="p1">
<span style="background-color: white;">In order to keep all data in a single logical scheduler, your schedulerName must be unique among all other nodes configuration files that belong in same cluster. Within the cluster, each nodeName must be unique. In fact, as default, the schedulerNode is default to your hostname already. So if you are running each scheduler on separate machines, you automatically will join into the default logical scheduler named "<span style="background-color: white;">TimeMachineScheduler</span><span style="background-color: white;">" with your hostname as node name.</span></span></div>
<span style="background-color: white;">
</span><br />
<span style="background-color: white;">
</span><br />
<div class="p1">
<span style="background-color: white;"><span style="background-color: white;"><br /></span></span><br />
<span style="background-color: white;"><span style="background-color: white;"><br /></span></span></div>
<span style="background-color: white;">

<h2>






Using HibernateDataStore</h2>
A typical and common way to run scalable data store is to use a database persistence. Our HibernateDataStore would let you run all clustered scheduler configuration and store the data in a database of your choice (well as many as Hibernate would support). Each scheduler node would record itself during start and stop with host IP and timestamp and etc. And each JobDef and Schedule are store per each logical SchedulerData, so the namespace is already in place. Each scheduler node would execute whatever schedule that's next run is due in a first "poll" first "run" fashion. If no schedules to be run, then the node would just be idling.<br />
<br />
<div class="p1">
<span style="background-color: white;"><br /></span></div>
<h2>






Using MemoryDataStore</h2>
Our MemoryDataStore implementation actually supports multiple scheduler as well! But it's not enabled as default. The default config is to use a new instance of the </span><span style="background-color: white;">MemoryDataStore </span><span style="background-color: white;">for data space, and thus the data will be lost and reset per scheduler start/stop. But if you add this config property:<br />


<br />
<div class="p2">
<span style="font-family: 'Courier New',Courier,monospace; font-size: x-small;">timemachine.scheduler.dataStore.memoryDataStore.useSingleton = true</span></div>
<div class="p1">
<span style="background-color: white;"><br /></span></div>
<div class="p1">
<span style="background-color: white;">This would make the MemoryDataStore service to use a singleton instance of the </span><span style="background-color: white;">MemoryDataStore </span><span style="background-color: white;"> for multiple schedulers to store data, thus making it cluster enable as well. This would be handy if you want to explore Big Memory or Data environment.</span></div>
<div class="p1">
<span style="background-color: white;"><br /></span></div>
<div class="p1">
<span style="background-color: white;"><br /></span></div>
</span><br />
<h2>







Summary</h2>
This would conclude our tour with the TimeMachine Scheduler. We hope these articles have given you helpful information to explore more. Our goals are to provide a scheduler that can scale well, able to run high&nbsp;concurrent&nbsp;jobs,<span style="background-color: white;">&nbsp;allow flexible schedules, and easy to configure. We love to hear your feedback.&nbsp;</span><span style="background-color: white;">Please visit the project site and join the user forum to participate.</span><br />
<br />
<div>
<br /></div>
<div>
End of part 7.&nbsp;<span style="background-color: white;">You may </span><span style="background-color: white;">see&nbsp;</span><a href="http://saltnlight5.blogspot.com/2012/06/timemachine-scheduler-tour-part6.html" style="background-color: white;">previous tour</a><span style="background-color: white;">.</span></div>
</p>

	<hr />
	
		</div>
		<div id="push"></div>
    </div>
    
    <div id="footer">
      <div class="container">
        <p class="muted credit">&copy; 2011 - 2019 Zemian Deng All Rights Reserved | Mixed with <a href="http://getbootstrap.com/">Bootstrap v3.1.1</a> | Baked with <a href="http://jbake.org">JBake v2.6.4</a></p>
      </div>
    </div>
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../../../js/jquery-1.11.1.min.js"></script>
    <script src="../../../js/bootstrap.min.js"></script>
    <script src="../../../js/prettify.js"></script>
    
  </body>
</html>